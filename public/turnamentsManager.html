<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.3/angular.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q"
        crossorigin="anonymous"></script>
    <title>Atriom - Post Tournaments</title>
</head>

<script>
    var mymodule = angular.module("kuchModule", []);

    mymodule.controller("kuchController", function ($scope, $http) {

        $scope.jsonArray = [];

        $scope.doFetchAll = function () {
            var url = "/do-fetch-all-users?emailidKuch=" + localStorage.getItem("activeUser");

            $http.get(url).then(allGoodFx, someBadFx);
            function allGoodFx(response) {
                $scope.jsonArray = response.data;
            }

            function someBadFx(response) {
                alert(JSON.stringify(response.data));
            }
        }
        //----------------------
        $scope.doDelete = function (rid, emailid) {

            var url = "/delete-one?rid=" + rid + "&emailid=" + emailid;

            $http.get(url).then(allGoodFx, someBadFx);
            function allGoodFx(response) {
                alert(response.data); //resp in string
                $scope.doFetchAll(emailid);
            }

            function someBadFx(response) {
                alert(JSON.stringify(response.data));
            }
        }
    })
</script>
<script>
    function showUser() {
        let activeUser = localStorage.getItem("activeUser");
        document.getElementById("inputEmailid").value = activeUser;
    }
</script>

<style>
    /* Global box-sizing for consistent layouts */
    *,
    *::before,
    *::after {
        box-sizing: border-box;
    }

    body {
        margin: 0;
        padding: 0;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
    }

    /* Navbar adjustments for responsiveness */
    .navbar {
        height: 65px;
        width: 100%;
        padding: 0 10px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .navbar-brand-img {
        border-radius: 50%;
        width: 50px;
        height: 50px;
        margin-left: 10px;
        margin-top: 0 !important;
        object-fit: cover;
    }

    .navbar-brand {
        font-size: 22px !important;
        /* Adjusted font size for mobile */
        margin-right: auto !important;
        /* Push elements to the right */
        margin-left: 8px;
    }

    /* Main content area */
    .main-content {
        flex-grow: 1;
        padding: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .form-section {
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 100%;
        max-width: 500px;
        /* Max width for form elements */
        margin-bottom: 20px;
        gap: 15px;
    }

    .form-group-email {
        width: 100%;
        display: flex;
        flex-direction: column;
        align-items: flex-start;
    }

    .form-group-email label {
        margin-right: 0;
        /* Remove specific margin */
        text-align: left;
        width: 100%;
    }

    .form-group-email input {
        width: 100%;
    }

    .fetch-button {
        width: 80%;
        /* Adjusted button width for mobile */
        height: 40px;
        /* Consistent button height */
        margin-left: 0 !important;
        margin-top: 10px !important;
        /* Space above button */
    }

    /* Responsive Table Styling */
    .table-responsive-custom {
        width: 100%;
        overflow-x: auto;
        /* Allows horizontal scroll on very small screens for the table */
        margin-bottom: 20px;
    }

    .data-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
        font-size: 0.9em;
        /* Slightly smaller font for table on mobile */
    }

    .data-table th,
    .data-table td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;
        white-space: nowrap;
        /* Prevent text wrapping in desktop view */
    }

    .data-table th {
        background-color: #f2f2f2;
        font-weight: bold;
    }

    .data-table input[type="button"] {
        padding: 6px 10px;
        font-size: 0.85em;
        border-radius: 4px;
        /* Slightly rounded corners */
        background-color: #dc3545;
        /* Bootstrap danger color */
        color: white;
        border: none;
        cursor: pointer;
    }

    .data-table input[type="button"]:hover {
        background-color: #c82333;
    }

    /* Mobile Table View (Default) */
    .data-table tbody tr {
        display: flex;
        flex-wrap: wrap;
        margin-bottom: 15px;
        border: 1px solid #ddd;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
    }

    .data-table td {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 10px 15px;
        border: none;
        border-bottom: 1px solid #eee;
        width: 100%;
        /* Each cell takes full width */
        white-space: normal;
        /* Allow text wrapping in mobile view */
        word-break: break-word;
    }

    .data-table td:last-child {
        border-bottom: none;
    }

    .data-table td::before {
        content: attr(data-label);
        font-weight: bold;
        margin-right: 10px;
        flex-shrink: 0;
        color: #555;
    }

    .data-table thead {
        display: none;
        /* Hide table headers on mobile */
    }

    /* Desktop Table View */
    @media (min-width: 768px) {
        .navbar {
            height: 80px;
            padding: 0 40px;
        }

        .navbar-brand-img {
            width: 90px;
            height: 80px;
            margin-left: 40px;
        }

        .navbar-brand {
            font-size: 32px !important;
            margin-right: 1220px !important;
            margin-left: 15px;
        }

        .main-content {
            padding: 30px 40px;
        }

        .form-section {
            flex-direction: row;
            /* Side-by-side for desktop */
            justify-content: center;
            align-items: flex-end;
            /* Align items to the bottom */
            max-width: none;
            /* Remove max-width constraint */
            width: auto;
            /* Let content define width */
            gap: 20px;
        }

        .form-group-email {
            width: auto;
            align-items: flex-start;
        }

        .form-group-email label {
            margin-right: 220px;
            /* Restore original margin */
            width: auto;
        }

        .form-group-email input {
            width: 300px;
            /* Specific width for input on desktop */
        }

        .fetch-button {
            width: 150px;
            /* Restore original button width */
            height: 36px;
            margin-left: 50px !important;
            margin-top: 33px !important;
        }

        .data-table {
            font-size: 1em;
            /* Restore original font size */
        }

        .data-table tbody tr {
            display: table-row;
            /* Revert to table row behavior */
            margin-bottom: 0;
            border-radius: 0;
            box-shadow: none;
        }

        .data-table td {
            display: table-cell;
            /* Revert to table cell behavior */
            border: 1px solid #ddd;
            padding: 8px;
            white-space: nowrap;
            /* Prevent wrapping */
        }

        .data-table td::before {
            content: none;
            /* Hide data labels on desktop */
        }

        .data-table thead {
            display: table-header-group;
            /* Show table headers on desktop */
        }
    }
</style>

<body ng-app="kuchModule" ng-controller="kuchController" onload="showUser()" ng-init="doFetchAll()">
    <nav class="navbar navbar-expand-lg bg-body-tertiary bg-primary">
        <div class="container-fluid">
            <img src="./pics/Preview.png" alt="Atriom Logo" class="navbar-brand-img">
            <a class="navbar-brand" href="/index.html">Atriom</a>
            </div>
    </nav>

    <div class="main-content">
        <h3 style="color:black">Post Tournaments</h3>

        <form class="form-section">
            <div class="form-group-email">
                <label for="inputEmailid" class="form-label">Email address</label>
                <input type="email" class="form-control" id="inputEmailid" aria-describedby="emailHelp" readonly>
            </div>
            <input type="button" value="Fetch All Records" class="btn btn-dark fetch-button" ng-click="doFetchAll();">
        </form>

        <div class="table-responsive-custom">
            <table class="data-table" border="1" rules="all">
                <thead>
                    <tr>
                        <th>Sr No.</th>
                        <th>Email id</th>
                        <th>Title</th>
                        <th>Date</th>
                        <th>Time</th>
                        <th>Address</th>
                        <th>State</th>
                        <th>Zip</th>
                        <th>Sports</th>
                        <th>Min Age</th>
                        <th>Max Age</th>
                        <th>Last Date</th>
                        <th>Reporting Time</th>
                        <th>Fee</th>
                        <th>Prize</th>
                        <th>Contact</th>
                        <th>Operations</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="obj in jsonArray">
                        <td data-label="Sr No.">{{$index+1}}</td>
                        <td data-label="Email ID">{{obj.emailid}}</td>
                        <td data-label="Title">{{obj.title}}</td>
                        <td data-label="Date">{{obj.doe}}</td>
                        <td data-label="Time">{{obj.toe}}</td>
                        <td data-label="Address">{{obj.address}}</td>
                        <td data-label="State">{{obj.state}}</td>
                        <td data-label="Zip">{{obj.zip}}</td>
                        <td data-label="Sports">{{obj.sports}}</td>
                        <td data-label="Min Age">{{obj.minage}}</td>
                        <td data-label="Max Age">{{obj.maxage}}</td>
                        <td data-label="Last Date">{{obj.lastdate}}</td>
                        <td data-label="Reporting Time">{{obj.timeR}}</td>
                        <td data-label="Fee">{{obj.fee}}</td>
                        <td data-label="Prize">{{obj.prize}}</td>
                        <td data-label="Contact">{{obj.contact}}</td>
                        <td data-label="Operations">
                            <input type="button" ng-click="doDelete(obj.rid,obj.emailid);" value="Remove">
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</body>

</html>