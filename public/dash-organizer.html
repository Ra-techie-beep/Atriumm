<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
        integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <title>Atriom Dashboard</title> <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q"
        crossorigin="anonymous"></script>
</head>
<script>
    function showUser() {
        let activeUser = localStorage.getItem("activeUser");
        const welcomeElement = document.getElementById("welcome");
        if (welcomeElement) {
            welcomeElement.innerHTML = activeUser;
        } else {
            console.warn("Element with ID 'welcome' not found. Cannot display active user.");
        }
    }

    function doLogout() {
        localStorage.removeItem("activeUser");
        location.href = "index.html";
    }
</script>
<script>
 $(document).ready(function () {
  // ðŸ‘‡ Handle the "Settings" button click inside modal
  $("#settingsinajax").click(function () {
    const email = $("#txtEmailid2").val();
    const currentPwd = $("#txtpass2").val();
    const newPwd = $("#txtrepeat2").val();

    // Simple front-end check (you already have blur validation, but this is runtime)
    if (!email || !currentPwd || !newPwd) {
      alert("All fields are required");
      return;
    }

    $.ajax({
      type: "GET",
      url: "/settingsorganizer",
      data: {
        txtEmailid2: email,
        txtpass2: currentPwd,
        txtrepeat2: newPwd
      }
    })
      .done(function (response) {
        alert("Settings updated: " + response);
        $('#divsettings').modal('hide');
        // Optionally clear fields
        $("#txtEmailid2, #txtpass2, #txtrepeat2").val("");
      })
      .fail(function (xhr) {
        alert("Error: " + (xhr.responseText || xhr.statusText));
      });
  });


  // Toggle current password visibility
  $("#eyesettingsorg").click(function () {
    let input = $("#txtpass2");
    let type = input.prop("type") === "password" ? "text" : "password";
    input.prop("type", type);
    $(this).toggleClass("fa-eye fa-eye-slash");
  });

  // (Optional) Toggle new password visibility
  $("#eyesettingsrorg").click(function () {
    let input = $("#txtrepeat2");
    let type = input.prop("type") === "password" ? "text" : "password";
    input.prop("type", type);
    $(this).toggleClass("fa-eye fa-eye-slash");
  });

        $("#txtpass2").blur(function () {
            let regex = /^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}$/;
            let pwd = $(this).val();
            if (pwd === "") {
                $("#errpass").html("Empty").addClass("notok").removeClass("ok");
            } else if (!regex.test(pwd)) {
                $("#errpass").html("Invalid Password").addClass("notok").removeClass("ok");
            } else {
                $("#errpass").html("Strong password").addClass("ok").removeClass("notok");
            }
        });

        $("#txtrepeat2").blur(function () {
            let regex = /^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}$/
;
            let pwd = $(this).val();
            if (pwd === "") {
                $("#errrepeat").html("Empty").addClass("notok").removeClass("ok");
            } else if (!regex.test(pwd)) {
                $("#errrepeat").html("Invalid Password").addClass("notok").removeClass("ok");
            } else {
                $("#errrepeat").html("Strong password").addClass("ok").removeClass("notok");
            }
        });

        $("#txtEmailid2").keyup(function () {
            let email = $(this).val();
            let regex = /^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/;
            if (email === "") {
                $("#errMsgee").html("Empty").addClass("notok").removeClass("ok");
            } else if (!regex.test(email)) {
                $("#errMsgee").html("Invalid Email ID").addClass("notok").removeClass("ok");
            } else {
                $("#errMsgee").html("Valid!").addClass("ok").removeClass("notok");
            }
        });
    });
</script>
<style>
    /* Global box-sizing for consistent layouts */
    *, *::before, *::after {
        box-sizing: border-box;
    }

    body {
        margin: 0;
        padding: 0;
        min-height: 100vh; /* Ensure body takes full viewport height */
        display: flex;
        flex-direction: column; /* Stack elements vertically */
    }

    /* Navbar adjustments for responsiveness */
    .navbar {
        height: 65px; /* Slightly reduced height for better mobile experience */
        width: 100%;
        padding: 0 10px; /* Add some padding on smaller screens */
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Subtle shadow */
    }

    .navbar-brand-img {
        border-radius: 50%; /* Keep circular */
        width: 50px; /* Adjusted size for better mobile fit */
        height: 50px;
        margin-left: 10px; /* Adjusted margin */
        margin-top: 0 !important; /* Remove negative margin to prevent layout shifts */
        object-fit: cover; /* Ensures image aspect ratio is maintained */
    }

    .navbar-brand {
        font-size: 22px !important; /* Adjusted font size for mobile */
        margin-right: auto !important; /* Push toggler and welcome message to the right on mobile */
        margin-left: 8px; /* Space between logo and brand name */
    }

    .navbar .me-5 { /* Targeting the welcome message specifically */
        margin-right: 10px !important; /* Adjusted margin for mobile */
        font-size: 0.9em; /* Smaller font for welcome message on mobile */
    }

    /* Main content area for cards and buttons */
    .main-content-area {
        flex-grow: 1; /* Allows this area to expand and take available space */
        display: flex;
        flex-direction: column; /* Default to column for mobile */
        align-items: center; /* Center items horizontally */
        justify-content: center; /* Center items vertically if space allows */
        padding: 20px; /* General padding for the content area */
        gap: 25px; /* Space between card-container and buttons */
    }

    /* Card Container - uses flexbox for responsive layout */
    .card-container {
        display: flex;
        flex-direction: column; /* Stack cards vertically on mobile */
        justify-content: center;
        align-items: center;
        width: 100%; /* Take full width on mobile */
        max-width: 320px; /* Max width for individual cards on mobile */
        gap: 25px; /* Space between cards */
        margin-top: 5%; /* Adjusted margin-top for mobile */
    }

    /* Individual Card Styles */
    .card.guidance {
        background: white;
        border: 1px solid var(--border-color);
        border-radius: 0.75rem;
        box-shadow: 5px 5px 5px 3px grey;
        transition: all 0.3s ease;
        width: 90%; /* Responsive width for mobile cards */
        height: auto; /* Allow height to adjust based on content */
        display: flex; /* Make card content stack properly */
        flex-direction: column;
        align-items: center;
        padding-bottom: 15px; /* Add padding at bottom for content */
    }

    .card.guidance:hover {
        transform: scaleY(1.03) scaleX(1.03); /* Slightly reduced scale effect for smoother hover */
        transition: all 0.3s ease;
    }

    .card-img-top {
        padding: 10px 10px 0px 10px;
        border-radius: 40px;
        width: 100%;
        height: 200px; /* Adjusted height for consistency and mobile fit */
        object-fit: cover; /* Ensures images fill space without distortion */
    }

    .card-body {
        display: flex; /* Use flex to center the button */
        justify-content: center;
        align-items: center;
        padding: 15px 10px 5px; /* Adjust padding for button */
        width: 100%;
    }

    .card-body .btn {
        width: 80%; /* Button takes more width within card body for easier tapping */
        padding: 10px 15px; /* Increase padding for better touch targets */
        font-size: 1rem; /* Standard font size */
        margin-left: 0 !important; /* Remove specific margin if any */
        margin-top: 0 !important; /* Remove specific margin if any */
    }

    /* Button Group for Settings/Logout */
    .button-group {
        display: flex;
        flex-direction: column; /* Stack buttons vertically on mobile */
        gap: 15px; /* Space between buttons */
        width: 90%; /* Take up most width on mobile */
        max-width: 300px; /* Max width for the button group */
        margin-top: 25px; /* Space from cards */
        margin-bottom: 20px; /* Space at the bottom */
    }

    .button-group .btn {
        padding: 12px 20px; /* Larger padding for easier taps */
        font-size: 1.05rem; /* Slightly larger text for buttons */
    }

    /* Validation messages - kept as per original request */
    .ok {
        color: green;
        padding: 1px;
        border-radius: 2px;
        font-size: 0.85em; /* Smaller text for validation messages */
    }

    .notok {
        color: red;
        padding: 1px;
        border-radius: 2px;
        font-size: 0.85em; /* Smaller text for validation messages */
    }

    /* Eye icon for password fields */
    .eye-icon {
        right: 15px;
        top: 50%;
        transform: translateY(-50%);
        cursor: pointer;
        z-index: 10;
        font-size: 1.1em; /* Make eye icon slightly larger */
        padding: 5px; /* Add padding to make icon easier to tap */
    }

    /* flexx div for validation messages */
    #flexx {
        min-height: 20px; /* Ensure space even if no message */
        display: flex;
        align-items: center;
    }

    /* Modal Adjustments for Responsiveness */
    .modal-dialog {
        max-width: 90%; /* Wider modal on smaller screens */
        margin: 1rem auto; /* Adjust margin for better fit */
    }

    .modal-content {
        padding: 15px; /* Inner padding for content */
    }

    .modal-header {
        padding-bottom: 10px; /* Adjust padding */
        margin-bottom: 15px;
        border-bottom: 1px solid #dee2e6; /* Bootstrap default border */
        display: flex; /* Ensure title and close button are aligned */
        justify-content: space-between;
        align-items: center;
    }

    .modal-title {
        font-size: 1.5rem; /* Adjust modal title size */
    }

    .modal-body > form > div {
        margin-bottom: 15px; /* Space between form groups */
    }

    .modal-footer {
        padding-top: 15px; /* Adjust padding */
        justify-content: center; /* Center the update button */
        border-top: none; /* Remove default border if not needed */
    }

    .modal-footer .btn {
        width: 70%; /* Make update button wider in modal */
        max-width: 200px; /* Limit max width */
        padding: 10px 15px; /* Adjust padding for button */
    }


    /* --- Media Queries for Laptop/Tablet --- */
    @media (min-width: 768px) {
        .navbar {
            height: 80px; /* Restore original height on larger screens */
            padding: 0 40px; /* More padding on wider screens */
        }

        .navbar-brand-img {
            width: 90px; /* Larger logo on laptop */
            height: 80px; /* Adjust height to match original */
            margin-left: 40px; /* Restore original margin */
        }

        .navbar-brand {
            font-size: 32px !important; /* Restore original font size */
            margin-right: 950px !important; /* Restore original margin-right */
            margin-left: 15px; /* Space between logo and brand */
        }

        .navbar .me-5 { /* Welcome message on laptop */
            margin-right: 20px !important;
            font-size: 1em; /* Restore font size */
        }

        .main-content-area {
            padding: 40px; /* More padding on wider screens */
        }

        .card-container {
            flex-direction: row; /* Layout cards side-by-side on larger screens */
            flex-wrap: wrap; /* Allow cards to wrap if needed */
            justify-content: center;
            align-items: flex-start; /* Align cards to the top within their container */
            width: 100%; /* Take full width for the container */
            max-width: 1200px; /* Max width for the card row on large screens */
            margin-top: 10%; /* Restore original margin-top */
        }

        .card.guidance {
            width: 14rem; /* Revert to original card width */
            flex: 0 1 calc(33.333% - 1rem); /* 3 cards per row with some gap */
            height: 325px; /* Restore original height */
            margin: 0 10px; /* Add horizontal margin between cards */
        }

        .card-img-top {
            height: 250px; /* Revert to original height */
        }

        .card-body .btn {
            width: auto; /* Allow button to size naturally based on content */
            padding: revert; /* Revert padding to default */
            /* Restore original specific margins if they were intentional */
            /* This is a bit tricky as the original had specific margins per button,
               so setting them back might not be perfectly 'responsive'
               but follows the 'no other changes' rule strictly for internal btn style */
        }
        /* Specific button width overrides to match original if needed, but not ideal for responsiveness */
        .card:nth-of-type(1) .card-body .btn { width: 90%; } /* Organization Details */
        .card:nth-of-type(2) .card-body .btn { width: 80%; } /* Introduce Event */
        .card:nth-of-type(3) .card-body .btn { width: 70%; margin-left: 16% !important; } /* Events */


        .button-group {
            flex-direction: row; /* Layout buttons side-by-side */
            width: auto; /* Auto width for buttons */
            max-width: none; /* Remove max-width constraint */
            margin-top: 30px; /* Adjust top margin as needed */
            margin-bottom: 30px; /* Add some space below */
        }

        .modal-dialog {
            max-width: 500px; /* Optimal width for modal on desktop */
            margin: 1.75rem auto; /* Bootstrap default margin */
        }

        .modal-footer .btn {
            width: auto; /* Allow button to size naturally */
            padding: revert; /* Revert padding to default */
        }
    }

    /* Ensuring validation messages are always displayed under input */
    .errMsgee, .errpass, .errrepeat {
        display: block; /* Ensure they take their own line */
        margin-top: 5px; /* Small space below input */
    }
</style>

<body onload="showUser();">
    <nav class="navbar navbar-expand-lg bg-body-tertiary bg-primary">
        <div class="container-fluid">
            <img src="./pics/Preview.png" alt="Atriom Logo" class="navbar-brand-img">
            <a class="navbar-brand" href="/index.html">Atriom</a>
            <div class="me-5 text-dark">Welcome @<span id="welcome"></span></div>
        </div>
    </nav>

    <div class="main-content-area">
        <div class="card-container">
            <div class="card guidance">
                <img src="./pics/PIC.png" class="card-img-top" alt="Organization Details Image">
                <div class="card-body">
                    <a href="/org-details.html" class="btn btn-danger">Organization Details</a>
                </div>
            </div>

            <div class="card guidance">
                <img src="./pics/lalala.png" class="card-img-top" alt="Introduce Event Image">
                <div class="card-body">
                    <a href="/post-tournament.html" class="btn btn-danger">Introduce Event</a>
                </div>
            </div>

            <div class="card guidance">
                <img src="./pics/output (1).png" class="card-img-top" alt="Events Image">
                <div class="card-body">
                    <a href="/turnamentsManager.html" class="btn btn-danger">Events</a>
                </div>
            </div>
        </div>

        <div class="button-group">
            <input type="button" class="btn btn-dark" value="Settings" data-bs-toggle="modal"
                data-bs-target="#divsettings">
            <input type="button" class="btn btn-dark" value="Logout" onclick="doLogout()">
        </div>
    </div>

    <div class="modal fade" tabindex="-1" id="divsettings">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header text-black">
                    <h5 class="modal-title">Settings</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div>
                            <label class="form-label">Email address</label>
                            <input type="text" class="form-control" id="txtEmailid2" name="txtEmailid"
                                placeholder="name123@gmail.com" required>
                            <div id="flexx">
                                <div id="errMsgee"></div>
                            </div>
                        </div>

                        <div class="mt-3">
                            <label class="form-label">Current Password</label>
                            <div class="position-relative">
                                <input type="password" class="form-control pe-5" id="txtpass2" name="txtpass2"
                                    placeholder="Password" required>
                                <i class="fa-solid fa-eye fa position-absolute eye-icon" id="eyesettingsorg"></i>
                            </div>
                            <div id="flexx">
                                <div id="errpass"></div>
                            </div>
                        </div>

                        <div class="mt-3">
                            <label class="form-label">New Password</label>
                            <div class="position-relative">
                                <input type="password" class="form-control pe-5" id="txtrepeat2" name="txtrepeat2"
                                    placeholder="Password" required>
                                <i class="fa-solid fa-eye fa position-absolute eye-icon" id="eyesettingsrorg"></i>
                            </div>
                            <div id="flexx">
                                <div id="errrepeat"></div>
                            </div>
                        </div>
                    </form>

                    <div class="modal-footer">
                        <input type="button" class="btn btn-dark" id="settingsinajax" value="Settings">
                    </div>
                </div>
            </div>
        </div>
    </div>

</body>

</html>